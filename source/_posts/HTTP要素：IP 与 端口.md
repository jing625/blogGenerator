---
title: HTTP访问要素:IP与端口
date: 2018-07-08 23:00:00
tags: TCP IP UDP HTTP 端口 内网  外网
---

# HTTP访问要素:IP与端口

## HTTP
* HTTP 协议的底层其实是由 TCP 协议和 IP 协议（简称 TCP/IP）构建的。

## TCP
* TCP : 传输控制协议（Transmission Control Protocol）  
本文重点不讲TCP，可以了解下面两条概念：

1. [TCP 和 UDP 的区别是什么?](https://www.nowcoder.com/questionTerminal/63c8b45c91a544bd8febc1f1ff02e3b5?toCommentId=73766)
简答：  
TCP ：可靠 、 面向连接、  相对UDP较慢。  
UDP ：不可靠、 不面向连接、 相对TCP较快。
2. [TCP 的三次握手指的是什么？](https://github.com/jawil/blog/issues/14)
```
 1. 客户端：我要连接你了，可以吗
 2. 服务端：嗯，我准备好了，连接我吧
 3. 客户端：那我连接你咯。
 4. 开始后面步骤
```

## IP
* IP ： 网络协议（英语：Internet Protocol）  

### 内网IP ：  
假如家里有一台路由器 ，手机电脑IPAD等都连接路由器 ，而路由器给这些设备分配的IP地址就是内网IP地址。  
一般内网IP格式为192.168.xxx.xxx 。
而通常路由器分给自己的内网IP是192.168.1.1 。如果不是就说明这个路由器的设置不是大众化的这种！    
所以路由分给手机的内网IP`可能`为192.168.1.2  ，分给电脑的内网IP`可能`为192.168.1.3  

### 外网IP ：  
如果路由器连上电信的服务器，那么路由器就会有一个外网IP 。  
外网IP格式 ： 暂时理解为只要不是192.168开头的就都是外网IP ，可能理解有误。   
如果路由器重启 ，则很有`可能`被重新分配一个外网IP ，也就是说路由器没有固定的外网IP。

### 内外网的访问  
 1. 内网可以直接访问外网么？  
 答案是`不能`，内网IP访问外网必须要通过路由器来中转 ，路由器只有连上了电信服务器，分配有外网IP才能访问外网。  
 2. 路由器的作用是什么，什么是路由？
 比如说我们手机要访问baidu.com  ，必须先经过路由中转然后路由外网IP对baidu.com 发送请求，百度收到后对路由响应一个网页或者  数据之类的东东。  
 路由器接收到 baidu.com 的页面后，把页面发送给你的电脑或手机。路由器知道如何给这些信息指路，路由器就是一个指路人，这就是「路由」两个字的来历。  
 路，就是「必由之路」中的路。由，就是「必由之路」中的由（由是经过、缘由的意思）。所有的信息都要经过路由器，然后被指向一条它该去的路。  
 也就是说内网和外网就像两个隔绝的空间，无法互通，唯一的联通点就是路由器（因为路由器既有外网 IP 也有内网 IP），所以路由器有时候也被叫做「网关」，这个「关」是「一夫当关，万夫莫开」的「关」。如果路由器到电信的连接中断了，那么内网中所有的设备也就无法上网了。（这很好理解，相当于唯一一条出去的路断了）  
 3. 内网能访问内网么？  
 内网中的设备可以互相访问（比如你可以用电脑或手机进入 http://192.168.1.1 来查看你的路由器），但是不能直接访问外网，内网设备想要访问外网，就必须经过路由器中转。  
 4. 外网能访问外网么？  
 外网中的设备可以互相访问（比如 qq.com 可以把首页发送给你的路由器，你的路由器有外网 IP），但是外网中的设备无法访问你的内网设备（这很好理解，内网是一个封闭的网络，外人进不来，所以实际上 qq.com 无法直接把首页放送给你的电脑和手机

### 本地IP  
这是一个特殊的IP ，代表着设备自己的IP。  
默认情况下，hosts 文件里会有一行127.0.0.1 localhost，意思就是 localhost 指向 127.0.0.1，所以 localhost 也表示设备自己。不信你 `ping localhost` 试试，会发现实际上是在 `ping 127.0.0.1`

### 特殊IP
IP：0.0.0.0，它不表示任何设备。这个 IP 不同的地方含义不同。

## 端口（Port）
你想要访问一个设备（前提是你使用的是 TCP 或 UDP 协议。还记得吗，HTTP 就使用了 TCP），只指定 IP 是不够的，必须指定端口。  
端口其实就是一个编号，并不是一种硬件。  
一个服务器（硬件）不一定只提供一种服务，比如一个服务器既提供 HTTP 服务，又提供 FTP 服务，还提供 SMTP 服务（邮件服务），那么只用一个 IP 是无法告诉服务器你想要使用哪种服务。  
所以这里有一个重要的原则：一个端口对应一个服务。
比如  
1. 要提供 HTTP 服务你最好使用 80 端口（能不能使用别的端口？可以，不过不建议你违反约定）
2. 要提供 HTTPS 服务你最好使用 443 端口（能不能使用别的端口？可以，不过不建议你违反约定）
3. 要提供 FTP 服务你最好使用 21 端口（能不能使用别的端口？可以，不过不建议你违反约定）

### 我怎么知道应该使用什么端口？
[维基百科](https://zh.wikipedia.org/wiki/TCP/UDP%E7%AB%AF%E5%8F%A3%E5%88%97%E8%A1%A8#0.E5.88.B01023.E5.8F.B7.E7.AB.AF.E5.8F.A3) 把 0 到 1023 号端口对应的服务都告诉你了，点进去看看吧。  

### 一共有多少端口？
每个机器一共有 65535（2的16次方减1）个端口（这是协议规定的）。不过这些端口的使用由一些规定：  
1. 0 到 1023（2的10次方减1）号端口是留给系统使用的，你只有拥有了管理员权限后，才能使用这 1024 个端口。
2. 其他端口可以给普通用户使用
3. 如果一个端口正在提供服务，也就是被占用了，那么就不能再使用这个端口。除非你先停掉正在占用这个端口的服务。以后你们会经常遇到这个问题。

## TCP/IP总结
上面都是 TCP/IP 相关的知识，如果你记不住，就记住下面这句话：

>使用 HTTP 协议访问另一个 IP 时，比如同时提供 IP 和端口号，缺一不可。

* 那么问题来了

我访问 http://qq.com 时并没有提供端口号，为什么我依然可以访问

>答：因为浏览器帮你加了默认端口号 80。
